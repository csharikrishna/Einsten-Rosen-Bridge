<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Interactive 3D visualization of an Einstein-Rosen bridge (wormhole)" />
  <title>Cosmic Wormhole Experience</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600;700&family=Rajdhani:wght@400;500;600&display=swap" rel="stylesheet" />
</head>

<body>
  <!-- Loading Screen -->
  <div class="loading-screen" id="loading">
    <h2>INITIALIZING WORMHOLE NAVIGATION</h2>
    <div class="loader" aria-label="Loading progress">
      <div class="loader-bar" id="loader-bar"></div>
    </div>
    <p id="loading-status">Calibrating space-time coordinates...</p>
  </div>

  <!-- Main Title -->
  <div class="title-overlay" id="title">EINSTEIN-ROSEN BRIDGE</div>

  <!-- Interface Panels -->
  <div class="interface">
    <!-- Information Panel -->
    <div class="info-panel panel">
      <h3>Einstein-Rosen Bridge</h3>
      <p>A theoretical passage through spacetime creating a shortcut connecting distant regions of the universe.</p>
      <p>This visualization represents a stable traversable wormhole with modified quantum energy conditions.</p>
      <div class="wormhole-types">
        <h4>Wormhole Types:</h4>
        <ul>
          <li><strong>Traversable:</strong> Matter can travel through</li>
          <li><strong>Non-traversable:</strong> Matter cannot travel through</li>
          <li><strong>Intra-universe:</strong> Connects two points within our universe</li>
          <li><strong>Inter-universe:</strong> Connects to another universe</li>
        </ul>
      </div>
      <p><small>Move mouse to navigate | Scroll to zoom | Press [J] to toggle journey mode</small></p>
    </div>

    <!-- Controls Panel -->
    <div class="controls-panel panel">
      <h3>Navigation Controls</h3>
      <div class="control-group">
        <label for="distortion">Space Distortion: <span id="distortion-value">50%</span></label>
        <input type="range" id="distortion" min="0" max="100" value="50" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50" />
      </div>
      <div class="control-group">
        <label for="wormhole-type">Wormhole Type:</label>
        <select id="wormhole-type" class="select-control">
          <option value="two-way">Two-way (Standard)</option>
          <option value="one-way">One-way</option>
          <option value="inter-universe">Inter-universe</option>
        </select>
      </div>
      <button class="journey-btn" id="journey-btn" aria-label="Begin journey through wormhole">Begin Journey</button>
    </div>

    <!-- Scientific Panel -->
    <div class="scientific-panel panel">
      <h3>Scientific Data</h3>
      <div class="data-display">
        <div class="data-item">
          <span class="data-label">Throat Diameter:</span>
          <span class="data-value" id="throat-diameter">350 units</span>
        </div>
        <div class="data-item">
          <span class="data-label">Exotic Matter:</span>
          <span class="data-value" id="exotic-matter">Stable</span>
        </div>
        <div class="data-item">
          <span class="data-label">Time Dilation:</span>
          <span class="data-value" id="time-dilation">1.00x</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Visual Effects -->
  <div class="cinematic-vignette" aria-hidden="true"></div>
  <div class="glitch-effect" id="glitch" aria-hidden="true"></div>
  <div class="lens-flare" id="lens-flare" aria-hidden="true"></div>

  <!-- Journey Progress Indicator -->
  <div class="journey-progress" id="journey-progress" aria-hidden="true">
    <div class="journey-progress-bar" id="journey-progress-bar"></div>
    <div class="journey-phase" id="journey-phase">Approaching Wormhole</div>
  </div>

  <!-- Interactive Hints -->
  <div class="interaction-hints" id="hints">
    <div class="hint" id="hint-1">Click on the wormhole center to activate journey mode</div>
  </div>

  <!-- Performance Monitor -->
  <div class="performance-monitor" id="performance-monitor">
    <div class="fps-counter" id="fps-counter">60 FPS</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/LuminosityHighPassShader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.min.js"></script>
  <!-- Important: GlitchPass must be included since it's used in setup.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/GlitchPass.min.js"></script>
  
  <!-- Handle modules properly -->
  <script type="module">
    // Import modules
    import { initScene } from './setup.js';
    import { initAnimation } from './animation.js';
    
    // Add specific error handler for script loading errors
    window.addEventListener('error', function(event) {
      console.error('Script error:', event.error);
      const loadingStatus = document.getElementById('loading-status');
      if (loadingStatus) {
        loadingStatus.textContent = "Error loading wormhole: " + (event.error ? event.error.message : "Unknown error");
      }
    }, { once: false, capture: true });
    
    // Initialize application after DOM is ready
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Initialize scene and wait for completion
        await initScene();
        // Start animation loop
        initAnimation();
      } catch (error) {
        console.error('Initialization error:', error);
        
        // Update loading status with error message
        const loadingStatus = document.getElementById('loading-status');
        if (loadingStatus) {
          loadingStatus.textContent = "Error initializing wormhole: " + error.message;
        }
        
        // Optionally hide loading screen after error
        setTimeout(() => {
          const loadingScreen = document.getElementById('loading');
          if (loadingScreen) {
            loadingScreen.classList.add('hidden');
          }
        }, 300);
      }
    });
  </script>
</body>
</html>
